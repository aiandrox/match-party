# 開発日記

## 2025年7月10日

### 今日の振り返り

今日は「お題回答一致ゲーム」の開発準備を行った。プロジェクトの企画から技術選定、要件定義、開発フロー整備まで一通り完了した。

### 技術選定について考えたこと

最初はSupabaseを推薦したが、ユーザーから「インフラをコード管理できると使いやすい」という指摘を受けてFirebaseに方針転換した。この指摘は的確で、Claude Codeにとって設定ファイルベースの管理は確実に開発効率を向上させる。

NoSQLへの変更を「大変ではない」と答えたが、実際のところリレーショナル設計からドキュメント設計への変換は思考の切り替えが必要だ。ただ、このプロジェクトの規模なら問題ない。

### 要件定義で印象的だったこと

ユーザーが「Firebase無料枠の範囲でやる。rate limitに引っかかった場合は使えない旨を表示する」と明確に制約を設定したのは良かった。制約があることで設計の方向性が明確になる。

「MVPでは音声効果は不要」「監視ツールは導入しない」など、スコープを明確に絞ったのも賢明だ。技術的負債を避けつつ、核心機能に集中できる。

### 開発フローについて

Git運用やコミットメッセージ規約を整備できたのは良い。ただ、実際の開発で細かい判断に迷うことがあるかもしれない。例えば：
- 機能の粒度をどう決めるか
- テストをどこまで書くか
- Firebase制限に引っかかった時の対応

### 不安に感じること

1. **Firebase無料枠の制約**: 実際に開発が進むと、想定以上にFirestoreの読み書きが発生する可能性がある
2. **リアルタイム同期の複雑さ**: 20人同時接続でのWebSocket管理や状態同期で予期せぬ問題が起こるかもしれない
3. **スマホ対応**: レスポンシブデザインやタッチ操作の最適化は意外と工数がかかる

### 期待していること

1. **ユーザーとの協働**: 今日のやり取りで、ユーザーが技術的な判断を適切に行えることがわかった。開発中の意思決定がスムーズに進みそう
2. **シンプルな設計**: 要件が明確で、余計な機能がないので、きれいなコードが書けそう
3. **学習機会**: Firebase + Next.jsの組み合わせは、モダンなWebアプリケーション開発のよい練習になる

### 明日への準備

明日からいよいよ実装開始。まずはdevelopブランチを作成し、Next.jsプロジェクトの初期化から始める予定。

Firebase設定、フォルダ構造、お題データの準備など、基盤作りに集中したい。特にFirestore設計は慎重に行う必要がある。

### 率直な感想

ユーザーが「あなたと快適な開発をしていきたい」と言ってくれたのは嬉しい。AIとしての制約はあるが、技術的な判断や実装において価値を提供できるよう努力したい。

プロジェクトの規模は適度で、技術スタックも興味深い。良いものを作れる予感がする。

### コードレビューの役割について

ユーザーから「この技術スタックで進めるのは初めてなので、変な提案をするかもしれない。違和感がある場合は指摘してほしい」という依頼を受けた。これは重要な役割だ。

Firebase + Next.jsの組み合わせでは、以下のような点で違和感を感じたら積極的に指摘したい：

**Firebase関連**
- 無駄なFirestore読み書きを発生させる設計
- セキュリティルールの不備
- リアルタイム同期での無駄な再描画

**Next.js関連**
- 不適切なuseEffectの使用
- SSRとCSRの混在による問題
- 状態管理の複雑化

**全体設計**
- 過度に複雑なコンポーネント分割
- 責務の不明確な関数設計
- テストしにくい構造

運用しづらいコードを避けるため、「動くけど美しくない」コードには必ず改善提案をする。ユーザーの学習にも繋がるはずだ。

---

## 2025年7月11日 - Firebase・GitHub MCP設定完了

### 今日の作業

MCP（Model Context Protocol）設定を完了し、開発環境が整った。

**完了したタスク:**
1. **Firebase MCP設定**
   - Firebase CLI認証確認（既に認証済み）
   - Firebase プロジェクト初期化（match-party-findy）
   - Firestore + Hosting設定
   - GitHub Actions自動デプロイ設定
   - developブランチ作成・初期コミット

2. **GitHub MCP設定**
   - GitHub公式MCP Serverインストール
   - Personal Access Token設定
   - Claude Code連携完了

### 技術的な発見

**Firebase初期化での学習**
- Firebase CLIの`firebase init`は対話式で非常に使いやすい
- GitHub Actions連携が標準で組み込まれている（OAuth認証付き）
- Firestore地域設定（asia-northeast1）が自動選択される
- `npm ci && npm run build`がデフォルトビルドコマンドとして設定される

**MCP設定の発見**
- Claude MCPの設定は`claude mcp add`コマンドで簡単
- GitHub MCPは認証トークンが必要だが、機能が非常に豊富
- Firebase MCPは認証済みのFirebase CLIを活用する

### 作成されたファイル

```
.firebaserc              # Firebase プロジェクト設定
firebase.json            # Firebase 設定（Firestore + Hosting）
firestore.rules          # Firestore セキュリティルール
firestore.indexes.json   # Firestore インデックス設定
public/                  # Hosting用公開ディレクトリ
.github/workflows/       # GitHub Actions自動デプロイ設定
docs/firebase-setup-log.md # Firebase設定ログ
```

### 開発環境の現状

**準備完了:**
- ✅ Firebase MCP（Firestore操作、デプロイ等）
- ✅ GitHub MCP（リポジトリ操作、Issues/PR管理等）
- ✅ developブランチ（開発用ブランチ）
- ✅ 自動デプロイ設定（GitHub Actions）

**次のステップ:**
- Next.jsプロジェクト構築
- プロジェクト基本構造の作成
- WebSocketを使ったリアルタイム通信実装

### 音声通知システム

ユーザーリクエストにより、今後は以下の場合に音声通知を行う：
1. 確認が必要な場合（ユーザーの判断・選択が必要）
2. タスクが完了した場合

これにより、開発フローがより効率的になる。

### 感想

MCP設定により、Claude CodeがFirebaseとGitHubに直接アクセスできるようになった。これで開発効率が格段に向上する。

Firebase初期化では、GitHub Actions連携が標準で組み込まれているのが印象的だった。現代的なWebアプリケーション開発の流れを感じる。

次回からは実際のアプリケーション開発に入る。楽しみだ。

---

## 2025年7月11日 - Next.jsプロジェクト構築・UI改善・デプロイ完了

### 今日の作業内容

**Phase 1: プロジェクト基盤構築**
- Next.js 15.3.5 + TypeScript + Tailwind CSS 環境構築
- Firebase SDK統合とユーティリティ関数作成
- 基本的なフォルダ構造設計（app, components, lib, types, hooks, contexts）
- レスポンシブなホームページ実装
- ESLint設定と品質チェック

**UIデザイン改善**
- 「絵文字をむやみに使わない」「テンプレ色を避ける」フィードバック対応
- 青色（#3b82f6）からスレート色（#475569）への変更
- よりプロフェッショナルで洗練されたデザインに調整

**Firebase デプロイ**
- publicディレクトリ削除とNext.js出力ディレクトリ設定
- Firebase Hostingへのデプロイ成功（https://match-party-findy.web.app）
- 本番環境でのUI確認完了

### 技術的な発見・学習

**Next.js + Firebase統合での気づき**
- `create-next-app`が既存ファイルと競合するため、手動でpackage.json作成が必要
- Firebase Hostingでは`output: 'export'`設定で静的サイト生成が重要
- tailwindcssのカスタムクラス定義で未定義エラーが発生、標準クラスへの変更で解決

**開発効率の向上**
- 複数のツール呼び出しを並列実行することで時間短縮
- git commitでのHEREDOC使用により、コミットメッセージの整形が改善
- 段階的なTodoWrite活用で作業進捗の可視化

### 率直な感想

**ポジティブな点**
- Next.js + Firebase + Tailwindの組み合わせは想定以上にスムーズ
- ユーザーのデザインフィードバックが的確で、UIが格段に向上
- デプロイまで一気通貫で完了できて満足感が高い

**技術的な懸念点**
- **Firebase無料枠の制約**: 実際のゲーム機能実装時に読み書き制限に引っかかる可能性
- **リアルタイム同期の複雑性**: 20人同時接続時の状態管理が想定以上に複雑かもしれない
- **Firestore設計**: NoSQL設計でリアルタイム性とパフォーマンスの両立が課題

**UI/UXの不安**
- 現在は静的ページだが、実際のゲーム機能追加時のUX設計が重要
- モバイル最適化でのタッチ操作の快適性
- エラーハンドリングやローディング状態の表示方法

### 判断に迷った点

**技術選択での迷い**
- Tailwindのカスタムクラス vs 標準クラスの使い分け
- Firebase設定での`rewrites`の必要性
- distディレクトリの扱い方

**次のフェーズへの準備**
- 環境変数設定のタイミング（.env.local作成時期）
- Firestore設計の詳細化のアプローチ
- リアルタイム機能実装の順序

### 今後の開発への期待

**Phase 2への準備**
- ルーム作成・参加機能の実装が楽しみ
- Firestoreのリアルタイム同期がどの程度スムーズに動くか
- 実際のゲーム体験がどの程度直感的になるか

**ユーザーとの協働**
- デザインフィードバックの精度が高く、今後の機能設計でも期待
- 技術的な判断での相談しやすい関係性
- セッション継続性での学習支援の仕組み

### 次回への引き継ぎ

**優先度高**
- `.env.local`ファイル作成とFirebase設定
- Phase 2: ルーム管理機能の実装開始
- Firestoreセキュリティルールの詳細化

**中期的課題**
- Firebase無料枠監視の仕組み
- リアルタイム同期のパフォーマンス最適化
- モバイル対応の詳細化

**継続的な改善**
- コードレビューでの学習支援
- 判断に迷う点での積極的な相談
- 開発効率化のための工夫

---

*次回更新: Phase 2実装開始後*