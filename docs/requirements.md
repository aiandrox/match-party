# 詳細要件定義

## 1. 技術的な確認事項

### Firebase設定
- **アカウント**: 個人アカウント
- **料金プラン**: Sparkプラン（無料枠）。Rate limitに引っかかった場合は使用不可メッセージを表示
- **地域設定**: asia-northeast1

### 開発環境
- **Node.js**: v18以上の最新安定版、バージョン管理を実施
- **パッケージマネージャー**: npm使用

## 2. 機能仕様の詳細

### 認証方式
- **方式**: 名前入力のみ
- **重複**: 同じルーム内では許可しない（先着順）
- **名前制限**: 2文字以上20文字以下、日本語・英語・数字を許可

### ルーム管理
- **ルームコード**: 20文字、英数字を使用
- **同時接続上限**: 20人（今後変更の可能性あり）
- **ルーム有効期限**: 30分（今後変更の可能性あり）

### お題管理
- **お題**: 事前定義、JSONなどでコード管理
- **カテゴリ分け**: 不要（全ルーム共通）
- **お題制限**: 30文字以下、日本語・英語・数字・記号を許可

## 3. UI/UX要件

### デザインシステム
- **ガイドライン**: シンプルで直感的なUIを目指す
- **カラーパレット**: 明るいトーンを基調
- **フォント**: 読みやすさを重視
- **レスポンシブ**: スマホ・タブレット・PCでの最適化

### 音声・効果
- **MVPフェーズ**: 音声効果は不要（後のフェーズで検討）

## 4. 運用・保守

### 監視・ログ
- **エラー監視**: Sentry等は導入しない、エラー時にSlack通知
- **アクセス解析**: Google Analytics等は導入しない（後のフェーズで検討）
- **パフォーマンス監視**: 導入しない（後のフェーズで検討）

### セキュリティ
- **不適切な回答対策**: MVPではやらない（後のフェーズで検討）
- **スパム対策**: 工数次第。同一IPからの短時間大量アクセス制限
- **レート制限**: 工数次第。一定時間内のリクエスト数制限

## 5. 実装優先度

### MVP Phase 1（プロジェクト基盤）- ✅ 完了
- [x] Next.js 15 + TypeScript + Tailwind CSS環境構築
- [x] Firebase SDK統合とFirestore設定
- [x] 基本的なフォルダ構造とコンポーネント設計
- [x] ホームページとナビゲーション
- [x] Firebase Hostingデプロイ設定

### MVP Phase 2（ルーム管理）- ✅ 完了
- [x] ルーム作成機能（20文字コード生成、重複チェック）
- [x] ルーム参加機能（名前バリデーション、人数制限）
- [x] 参加者一覧とリアルタイム更新
- [x] ホスト権限管理とゲーム開始制御
- [x] セキュリティ強化（参加権限、有効期限管理）
- [x] localStorage活用したユーザー識別システム

### MVP Phase 3（ゲーム機能）- ✅ 完了
- [x] ゲーム開始とお題表示システム
- [x] 30個のお題データ（JSON形式）
- [x] 回答送信とリアルタイム同期
- [x] 全員回答完了の自動判定
- [x] 回答公開機能
- [x] 主催者による手動一致判定
- [x] 判定結果の全参加者への配信
- [x] ゲーム状態管理（waiting → playing → revealing）

### Phase 4（拡張機能）- 🔄 検討中
- [ ] 次ラウンド機能（新しいお題での継続）
- [ ] ゲーム終了機能（最終結果表示）
- [ ] 複数ラウンドでの得点システム
- [ ] 音声・視覚効果の追加
- [ ] ゲーム履歴の保存

### Phase 5（運用改善）- 📋 将来検討
- [ ] 監視・ログ機能
- [ ] パフォーマンス最適化
- [ ] セキュリティ強化
- [ ] 不適切コンテンツ対策
- [ ] Firebase使用量監視ダッシュボード

## 6. 技術的制約

### Firebase無料枠制限
- **Firestore**: 読み取り50,000回/日、書き込み20,000回/日
- **Cloud Functions**: 呼び出し2,000,000回/月
- **Hosting**: 10GB/月

### Rate Limit対策
- 制限に達した場合の適切なエラーメッセージ表示
- ユーザーへの制限状況の透明性確保

## 7. 開発時の注意点

### データ設計
- 無料枠を意識した効率的なクエリ設計
- 不要な読み書きを避ける構造

### UI/UX
- ローディング状態の適切な表示
- エラー状態の分かりやすい表示
- モバイルファーストのレスポンシブデザイン